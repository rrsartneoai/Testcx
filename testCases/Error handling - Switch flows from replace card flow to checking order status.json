{
  "name": "2adb8e56-1546-44e4-9a1c-958394e2e3e4",
  "tags": [ "#switchflows", "#account", "#replacecard", "#orders", "#orderstatus" ],
  "displayName": "Error handling - Switch flows from replace card flow to checking order status",
  "testCaseConversationTurns": [ {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Hi I lost my membership card"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "allow_guest_login": false,
        "has_welcomed_user": true,
        "is_returning": true,
        "operation": "Replace Card",
        "operation_complete": false
      },
      "triggeredIntent": {
        "name": "retail.replace_loyalty_card_initiate"
      },
      "currentPage": {
        "name": "Clarify Phone Number",
        "flow": "User Verification Flow"
      },
      "textResponses": [ {
        "text": [ "I'll need some account information first." ],
        "allowPlaybackInterruption": true
      }, {
        "text": [ "Is the phone number you're calling from the same one that was used with your account?" ],
        "allowPlaybackInterruption": true
      } ],
      "currentFlow": {
        "name": "User Verification Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Yes"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "allow_guest_login": false,
        "has_welcomed_user": true,
        "is_returning": true,
        "operation": "Replace Card",
        "operation_complete": false
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.yes"
      },
      "currentPage": {
        "name": "Request to send PIN",
        "flow": "User Verification Flow"
      },
      "textResponses": [ {
        "text": [ "Okay, your phone number has been verified." ],
        "allowPlaybackInterruption": true
      }, {
        "text": [ "I'll need to send you a PIN to authenticate you. Would you like me to send it? Standard message charges may apply." ],
        "allowPlaybackInterruption": true
      } ],
      "currentFlow": {
        "name": "User Verification Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Yes"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "allow_guest_login": false,
        "has_welcomed_user": true,
        "is_returning": true,
        "operation": "Replace Card",
        "operation_complete": false
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.yes"
      },
      "currentPage": {
        "name": "Collect PIN",
        "flow": "User Verification Flow"
      },
      "textResponses": [ {
        "text": [ "I've sent a 4 digit PIN to your phone. Please provide the PIN you received, either by saying it or entering it into your keypad." ],
        "allowPlaybackInterruption": true
      } ],
      "currentFlow": {
        "name": "User Verification Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "3948"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": true,
        "operation_complete": false,
        "pin_number": "3948"
      },
      "currentPage": {
        "name": "Verify Delivery Address",
        "flow": "Card Replacement Flow"
      },
      "textResponses": [ {
        "text": [ "Thank you! I have verified your account." ],
        "allowPlaybackInterruption": true
      }, {
        "text": [ "Before I can send a replacement card, I'll need to verify your delivery address. Is your address still 1600 Amphitheatre Parkway, Mountain View, CA 94043?" ],
        "allowPlaybackInterruption": true
      } ],
      "currentFlow": {
        "name": "Card Replacement Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Actually can I check the status of my order"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": true,
        "operation": "Check Status",
        "operation_complete": false,
        "pin_number": "3948"
      },
      "triggeredIntent": {
        "name": "retail.check_order_status_initiate"
      },
      "currentPage": {
        "name": "Check Recent Order",
        "flow": "Order Management Flow"
      },
      "textResponses": [ {
        "text": [ "Sure, no problem. " ],
        "allowPlaybackInterruption": true
      }, {
        "text": [ "Is this about the Google Home you purchased recently?" ],
        "allowPlaybackInterruption": true
      } ],
      "currentFlow": {
        "name": "Order Management Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Yes"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_completed_one_operation": true,
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": false,
        "operation_complete": false,
        "order_number": "12345",
        "order_unit": "Google Home",
        "pin_number": "3948"
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.yes"
      },
      "currentPage": {
        "name": "Main Menu",
        "flow": "Default Start Flow"
      },
      "textResponses": [ {
        "text": [ "The order is currently being processed. You should get an email with a tracking number when it ships." ],
        "allowPlaybackInterruption": true
      }, {
        "text": [ "Can I help you with anything else?" ],
        "allowPlaybackInterruption": true
      } ],
      "currentFlow": {
        "name": "Default Start Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "No thank you"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_completed_one_operation": true,
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": false,
        "operation_complete": false,
        "order_number": "12345",
        "order_unit": "Google Home",
        "pin_number": "3948"
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.no"
      },
      "currentPage": {
        "name": "End Session",
        "flow": "Default Start Flow"
      },
      "textResponses": [ {
        "text": [ "In that case, thank you for calling. Goodbye!" ],
        "allowPlaybackInterruption": true
      } ],
      "currentFlow": {
        "name": "Default Start Flow"
      }
    }
  } ],
  "creationTime": {
    "seconds": 1607556311,
    "nanos": 132636000
  }
}
