{
  "name": "1a769962-b94e-4dae-b432-9485ddc7fc3c",
  "tags": [ "#switchflows", "#account", "#updateaddress", "#points" ],
  "displayName": "Error handling - Switch flows from update address flow to check loyalty points after new address in entered",
  "testCaseConversationTurns": [ {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Hi can I update my address"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "allow_guest_login": false,
        "has_welcomed_user": true,
        "is_returning": true,
        "operation": "Update Address",
        "operation_complete": false
      },
      "triggeredIntent": {
        "name": "retail.update_account_address_initiate"
      },
      "currentPage": {
        "name": "Clarify Phone Number",
        "flow": "User Verification Flow"
      },
      "textResponses": [ {
        "text": [ "I'll need to verify your account first." ]
      }, {
        "text": [ "Is the phone number you're dialing from registered with your account?" ]
      } ],
      "currentFlow": {
        "name": "User Verification Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Yes"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "allow_guest_login": false,
        "has_welcomed_user": true,
        "is_returning": true,
        "operation": "Update Address",
        "operation_complete": false
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.yes"
      },
      "currentPage": {
        "name": "Request to send PIN",
        "flow": "User Verification Flow"
      },
      "textResponses": [ {
        "text": [ "Okay, your phone number has been verified." ]
      }, {
        "text": [ "I'll need to authenticate you. Can I send a PIN to your phone? Standard message charges may apply." ]
      } ],
      "currentFlow": {
        "name": "User Verification Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Yes"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "allow_guest_login": false,
        "has_welcomed_user": true,
        "is_returning": true,
        "operation": "Update Address",
        "operation_complete": false
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.yes"
      },
      "currentPage": {
        "name": "Collect PIN",
        "flow": "User Verification Flow"
      },
      "textResponses": [ {
        "text": [ "I've sent a 4 digit PIN to your phone." ]
      }, {
        "text": [ "Please provide the PIN you received, either by saying it or entering it into your keypad." ]
      } ],
      "currentFlow": {
        "name": "User Verification Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "4803"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": true,
        "operation_complete": false,
        "pin_number": "4803"
      },
      "currentPage": {
        "name": "Request User Location",
        "flow": "Address Collection Flow"
      },
      "textResponses": [ {
        "text": [ "Great! Your account has been verified." ]
      }, {
        "text": [ "I'll need to verify your old address first." ]
      }, {
        "text": [ "May I have your street address?" ]
      } ],
      "currentFlow": {
        "name": "Address Collection Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "1600 amphitheatre parkway"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": true,
        "location": {
          "original": "1600 amphitheatre parkway",
          "street-address": "1600 amphitheatre parkway"
        },
        "operation_complete": false,
        "pin_number": "4803"
      },
      "currentPage": {
        "name": "Request Zip Code",
        "flow": "Address Collection Flow"
      },
      "textResponses": [ {
        "text": [ "May I have your zip code? You can say it out loud or type it in." ]
      } ],
      "currentFlow": {
        "name": "Address Collection Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "94043"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": true,
        "operation_complete": false,
        "pin_number": "4803"
      },
      "currentPage": {
        "name": "Request User Location",
        "flow": "Address Collection Flow"
      },
      "textResponses": [ {
        "text": [ "Thanks, I have verified your old address. I'll just need your new address." ]
      }, {
        "text": [ "May I have your street address?" ]
      } ],
      "currentFlow": {
        "name": "Address Collection Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "345 spear street San Francisco California"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": true,
        "location": {
          "admin-area": "California",
          "city": "San Francisco",
          "original": "345 spear street San Francisco California",
          "street-address": "345 spear street"
        },
        "operation_complete": false,
        "pin_number": "4803"
      },
      "currentPage": {
        "name": "Confirm New Address",
        "flow": "Address Update Flow"
      },
      "textResponses": [ {
        "text": [ "I heard 345 spear street San Francisco California. Is that correct?" ]
      } ],
      "currentFlow": {
        "name": "Address Update Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Actually can I check my loyalty points please"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_completed_one_operation": true,
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": false,
        "operation_complete": false,
        "pin_number": "4803"
      },
      "triggeredIntent": {
        "name": "retail.account_loyalty_points_initiate"
      },
      "currentPage": {
        "name": "Main Menu",
        "flow": "Default Start Flow"
      },
      "textResponses": [ {
        "text": [ "You have 3402 loyalty points available." ]
      }, {
        "text": [ "Can I help you with anything else?" ]
      } ],
      "currentFlow": {
        "name": "Default Start Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "No thank you"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_completed_one_operation": true,
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": false,
        "operation_complete": false,
        "pin_number": "4803"
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.no"
      },
      "currentPage": {
        "name": "End Session",
        "flow": "Default Start Flow"
      },
      "textResponses": [ {
        "text": [ "Glad I could help! Thank you for calling. Bye!" ]
      } ],
      "currentFlow": {
        "name": "Default Start Flow"
      }
    }
  } ],
  "creationTime": {
    "seconds": 1607494476,
    "nanos": 268151000
  }
}
