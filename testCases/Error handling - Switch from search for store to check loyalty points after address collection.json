{
  "name": "e3703061-72bf-479c-8837-753f1160507e",
  "tags": [ "#search", "#points", "#switchflows" ],
  "displayName": "Error handling - Switch from search for store to check loyalty points after address collection",
  "testCaseConversationTurns": [ {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Hello"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "triggeredIntent": {
        "name": "Default Welcome Intent"
      },
      "currentPage": {
        "name": "Main Menu",
        "flow": "Default Start Flow"
      },
      "textResponses": [ {
        "text": [ "Greetings! How can I assist?" ]
      } ],
      "currentFlow": {
        "name": "Default Start Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "I'm looking for a store"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "is_returning": true,
        "operation": "Search Store"
      },
      "triggeredIntent": {
        "name": "retail.nearest_store_initiate"
      },
      "currentPage": {
        "name": "Request User Location",
        "flow": "Address Collection Flow"
      },
      "textResponses": [ {
        "text": [ "I can help look that up." ]
      }, {
        "text": [ "What's your street address?" ]
      } ],
      "currentFlow": {
        "name": "Address Collection Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "100 main street San Francisco California"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "is_returning": true,
        "location": {
          "admin-area": "California",
          "city": "San Francisco",
          "original": "100 main street San Francisco California",
          "street-address": "100 main street"
        },
        "operation": "Search Store",
        "store-id": 2,
        "stores": [ "1600 Amphitheatre Parkway, Mountain View, California 94043" ]
      },
      "currentPage": {
        "name": "Ask About Store Hours",
        "flow": "Store Search Flow"
      },
      "textResponses": [ {
        "text": [ "I found one location at 1600 Amphitheatre Parkway, Mountain View, California 94043." ]
      }, {
        "text": [ "Would you like me to tell you about the store hours?" ]
      } ],
      "currentFlow": {
        "name": "Store Search Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "No could I check my points"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "allow_guest_login": false,
        "is_returning": true,
        "operation": "Loyalty Points",
        "stores": [ "1600 Amphitheatre Parkway, Mountain View, California 94043" ]
      },
      "triggeredIntent": {
        "name": "retail.account_loyalty_points_initiate"
      },
      "currentPage": {
        "name": "Clarify Phone Number",
        "flow": "User Verification Flow"
      },
      "textResponses": [ {
        "text": [ "First, let me verify your account details." ]
      }, {
        "text": [ "Is the phone number you're calling from the same one that was used with your account?" ]
      } ],
      "currentFlow": {
        "name": "User Verification Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Yes"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "allow_guest_login": false,
        "is_returning": true,
        "operation": "Loyalty Points",
        "stores": [ "1600 Amphitheatre Parkway, Mountain View, California 94043" ]
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.yes"
      },
      "currentPage": {
        "name": "Request to send PIN",
        "flow": "User Verification Flow"
      },
      "textResponses": [ {
        "text": [ "Okay, your phone number has been verified." ]
      }, {
        "text": [ "I'll need to send you a PIN to authenticate you. Would you like me to send it?" ]
      } ],
      "currentFlow": {
        "name": "User Verification Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Yes"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "allow_guest_login": false,
        "is_returning": true,
        "operation": "Loyalty Points",
        "stores": [ "1600 Amphitheatre Parkway, Mountain View, California 94043" ]
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.yes"
      },
      "currentPage": {
        "name": "Collect PIN",
        "flow": "User Verification Flow"
      },
      "textResponses": [ {
        "text": [ "I've sent a 4 digit PIN to your phone." ]
      }, {
        "text": [ "May I have the PIN you received? You can either say it or use your keypad." ]
      } ],
      "currentFlow": {
        "name": "User Verification Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "1234"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "is_guest": false,
        "is_logged_in": true,
        "stores": [ "1600 Amphitheatre Parkway, Mountain View, California 94043" ]
      },
      "currentPage": {
        "name": "Main Menu",
        "flow": "Default Start Flow"
      },
      "textResponses": [ {
        "text": [ "Thank you! I have verified your account." ]
      }, {
        "text": [ "Your loyalty points are 2200." ]
      }, {
        "text": [ "Can I help you with anything else?" ]
      } ],
      "currentFlow": {
        "name": "Default Start Flow"
      }
    }
  } ],
  "creationTime": {
    "seconds": 1605813208,
    "nanos": 664487000
  }
}
