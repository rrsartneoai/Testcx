{
  "name": "cb849483-8d91-41ab-908c-9bbaad667468",
  "tags": [ "#purchase" ],
  "displayName": "Happy path - Purchase item after logging in but using a different address than the one on file",
  "testCaseConversationTurns": [ {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Hi can I buy a google home"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_welcomed_user": true,
        "is_returning": true,
        "operation": "Purchase Item",
        "operation_complete": false,
        "order_unit": "Google Home"
      },
      "triggeredIntent": {
        "name": "retail.purchase_item_initiate"
      },
      "currentPage": {
        "name": "Check Login",
        "flow": "Purchase Item Flow"
      },
      "textResponses": [ {
        "text": [ "Of course, I am happy to assist with that. Would you like to login or continue as a guest?" ]
      } ],
      "currentFlow": {
        "name": "Purchase Item Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Log in "
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_welcomed_user": true,
        "is_returning": true,
        "operation": "Purchase Item",
        "operation_complete": false,
        "order_unit": "Google Home"
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.user_login"
      },
      "currentPage": {
        "name": "Clarify Phone Number",
        "flow": "User Verification Flow"
      },
      "textResponses": [ {
        "text": [ "I'll need to verify your account first." ]
      }, {
        "text": [ "Is the phone number you're calling from the same one registered with your account?" ]
      } ],
      "currentFlow": {
        "name": "User Verification Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Yes"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_welcomed_user": true,
        "is_returning": true,
        "operation": "Purchase Item",
        "operation_complete": false,
        "order_unit": "Google Home"
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.yes"
      },
      "currentPage": {
        "name": "Request to send PIN",
        "flow": "User Verification Flow"
      },
      "textResponses": [ {
        "text": [ "Thanks, I have verified your phone number." ]
      }, {
        "text": [ "I'll need to authenticate you. Can I send a PIN to your phone? Standard message charges may apply." ]
      } ],
      "currentFlow": {
        "name": "User Verification Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Yes"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_welcomed_user": true,
        "is_returning": true,
        "operation": "Purchase Item",
        "operation_complete": false,
        "order_unit": "Google Home"
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.yes"
      },
      "currentPage": {
        "name": "Collect PIN",
        "flow": "User Verification Flow"
      },
      "textResponses": [ {
        "text": [ "I've sent you a 4 digit PIN. Could you please give me the PIN you received? You can say it or enter it into the keypad." ],
        "allowPlaybackInterruption": true
      } ],
      "currentFlow": {
        "name": "User Verification Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "4839"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "cart": "Google Home",
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": true,
        "operation": "Purchase Item",
        "operation_complete": false,
        "order_unit": "Google Home",
        "pin_number": "4839"
      },
      "currentPage": {
        "name": "Add to Cart",
        "flow": "Purchase Item Flow"
      },
      "textResponses": [ {
        "text": [ "Thank you! I have verified your account." ]
      }, {
        "text": [ "I have added a Google Home to your cart." ]
      }, {
        "text": [ "What else would you like to order?" ]
      } ],
      "currentFlow": {
        "name": "Purchase Item Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "No"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "cart": "Google Home",
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": true,
        "operation": "Purchase Item",
        "operation_complete": false,
        "order_unit": "Google Home",
        "pin_number": "4839"
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.no"
      },
      "currentPage": {
        "name": "Ask to Use Existing Address",
        "flow": "Purchase Item Flow"
      },
      "textResponses": [ {
        "text": [ "Okay, let's go ahead and begin checkout." ]
      }, {
        "text": [ "Looks like your cart has the following, Google Home." ]
      }, {
        "text": [ "Would you like to use the shipping address on file?" ]
      } ],
      "currentFlow": {
        "name": "Purchase Item Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "My address has changed"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "cart": "Google Home",
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": true,
        "operation": "Purchase Item",
        "operation_complete": false,
        "order_unit": "Google Home",
        "pin_number": "4839"
      },
      "triggeredIntent": {
        "name": "retail.address_changed"
      },
      "currentPage": {
        "name": "Request User Location",
        "flow": "Address Collection Flow"
      },
      "textResponses": [ {
        "text": [ "Can I get your street address?" ]
      } ],
      "currentFlow": {
        "name": "Address Collection Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "345 spear street San Francisco California"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "cart": "Google Home",
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": true,
        "location": {
          "admin-area": "California",
          "city": "San Francisco",
          "original": "345 spear street San Francisco California",
          "street-address": "345 spear street"
        },
        "operation": "Purchase Item",
        "operation_complete": false,
        "order_unit": "Google Home",
        "pin_number": "4839"
      },
      "currentPage": {
        "name": "Confirm Shipping Address",
        "flow": "Purchase Item Flow"
      },
      "textResponses": [ {
        "text": [ "I heard 345 spear street San Francisco California. Is that correct?" ]
      } ],
      "currentFlow": {
        "name": "Purchase Item Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Yes"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "cart": "Google Home",
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": true,
        "location": {
          "admin-area": "California",
          "city": "San Francisco",
          "original": "345 spear street San Francisco California",
          "street-address": "345 spear street"
        },
        "operation": "Purchase Item",
        "operation_complete": false,
        "order_unit": "Google Home",
        "pin_number": "4839"
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.yes"
      },
      "currentPage": {
        "name": "Ask to Use Existing Billing Details",
        "flow": "Purchase Item Flow"
      },
      "textResponses": [ {
        "text": [ "Would you like to use the credit card on file?" ]
      } ],
      "currentFlow": {
        "name": "Purchase Item Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Yes"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "cart": "Google Home",
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": true,
        "location": {
          "admin-area": "California",
          "city": "San Francisco",
          "original": "345 spear street San Francisco California",
          "street-address": "345 spear street"
        },
        "operation": "Purchase Item",
        "operation_complete": false,
        "order_unit": "Google Home",
        "pin_number": "4839"
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.yes"
      },
      "currentPage": {
        "name": "Confirm Billing Details",
        "flow": "Purchase Item Flow"
      },
      "textResponses": [ {
        "text": [ "To complete the process could you please confirm the last 4 digits of the card on file?" ]
      } ],
      "currentFlow": {
        "name": "Purchase Item Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "4820"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_completed_one_operation": true,
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": false,
        "last_four": 4820,
        "location": {
          "admin-area": "California",
          "city": "San Francisco",
          "original": "345 spear street San Francisco California",
          "street-address": "345 spear street"
        },
        "operation_complete": false,
        "pin_number": "4839"
      },
      "triggeredIntent": {
        "name": "retail.extract.credit_card_last_four"
      },
      "currentPage": {
        "name": "Main Menu",
        "flow": "Default Start Flow"
      },
      "textResponses": [ {
        "text": [ "I have placed the order for you. You should receive a confirmation text soon." ]
      }, {
        "text": [ "What else can I help you with?" ]
      } ],
      "currentFlow": {
        "name": "Default Start Flow"
      }
    }
  }, {
    "userInput": {
      "isWebhookEnabled": true,
      "input": {
        "text": {
          "text": "Nothing else"
        },
        "languageCode": "en"
      }
    },
    "virtualAgentOutput": {
      "sessionParameters": {
        "has_completed_one_operation": true,
        "has_welcomed_user": true,
        "is_guest": false,
        "is_logged_in": true,
        "is_returning": false,
        "last_four": 4820,
        "location": {
          "admin-area": "California",
          "city": "San Francisco",
          "original": "345 spear street San Francisco California",
          "street-address": "345 spear street"
        },
        "operation_complete": false,
        "pin_number": "4839"
      },
      "triggeredIntent": {
        "name": "small_talk.confirmation.no_thats_all"
      },
      "currentPage": {
        "name": "End Session",
        "flow": "Default Start Flow"
      },
      "textResponses": [ {
        "text": [ "In that case, thank you for calling. Goodbye!" ]
      } ],
      "currentFlow": {
        "name": "Default Start Flow"
      }
    }
  } ],
  "creationTime": {
    "seconds": 1607552086,
    "nanos": 109094000
  }
}
